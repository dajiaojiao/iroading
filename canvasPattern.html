<!DOCTYPE html>
<html lang="zh">
<head>
	<meta charset="utf-8">
	<title>Canvas画图基础-渐变圆环</title>
</head>
<body>
	<canvas id="canvas" width="300" height="300" ></canvas>
	<canvas id="canvas1" width="300" height="300" ></canvas>
    <canvas id="canvas2" width="1000" height="1000" ></canvas>
    <img src="./images/bg.jpg" style="position:absolute;left:0;top:0;">
</body>

<style type="text/css">
	body {background-color: #ccc;}
</style>
<!-- <script src="http://cdn.bootcss.com/jquery/2.2.4/jquery.js"></script> -->


<script type="text/javascript">
	var canvas = document.getElementById("canvas2");
	var ctx2 = canvas.getContext('2d');
	ctx2.lineWidth = 8;
	ctx2.lineCap="round";

    var img;

    img = new Image();
    img.src = "./images/bg.jpg";
    // img.width = 150;
    // img.height = 150;


    if (img.complete) {
       setImageFill();
    } else {
       img.onload = setImageFill;
    }

    var newFill = null;
    function setImageFill() {
        // var bg = $('<canvas>')[0];

        // var size = 100;
        // bg.width = size;
        // bg.height = size;
        // bg.getContext('2d').drawImage(img, 0, 0, size, size);
    	newFill = ctx2.createPattern(img, 'no-repeat');
    	drawNew(ctx2, 0);
    }

    function drawNew(ctx, x) {
        ctx.clearRect(0, 0, 500, 500);
        ctx.beginPath();
        ctx.strokeStyle = newFill;
        if (x < Math.PI*2) {
            x += Math.PI/100;
        } else {
            x = 0;
        }
        // x = Math.PI*2;
        ctx.arc(350, 350, 50, 0, Math.PI*2, false);
        ctx.stroke();
        requestAnimationFrame(function () {
            drawNew(ctx, x);
        });
    }
	
</script>

</html>